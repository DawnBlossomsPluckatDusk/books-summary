# 图书介绍

[豆瓣介绍](https://book.douban.com/subject/35857731/)

# 阅读时间

读完的时间点：2022.7.12

预计需要的时间： 一周

# 大纲

该书以入门为主，相当于计算机系统结构的科普书籍，书中介绍的技术大多属于较为成熟，且已经在工业领域广泛使用。

对于计算机体系结构的新手，或是想要了解一些关于现代计算机的基本知识，这是一本好书

## CPU概览篇与CPU术语篇

在概览篇，有三个关键点：

1. CPU在当代社会的重要性
2. 如何评价一颗CPU，性能，功耗....
3. CPU的研发，即CPU的相关知识

在CPU术语篇，该部分主要介绍一些常见的术语，从指令集（ISA）向上到 微结构，再到操作系统

## CPU原理篇

该部分主要介绍现代CPU常用的技术：
1. 流水线
2. 乱序执行
3. 分支预测
4. 多发射

## CPU系统篇

该部分注重于计算机系统，如何将一颗CPU和其他部件，如内存，外设等相互关联；同时介绍了并行的巨大力量

## CPU生产制造篇

该部分介绍了如何从沙粒到具有超强计算能力芯片，在该部分，成本是关键因素

## CPU家族和生态篇，以及中国的CPU

主要解读现代的CPU厂家的发展历史

# 重点

## CPU概览篇与CPU术语篇
### CPU时代
1. 冯诺伊曼体系结构：五大部件，基本思想：计算机 = 程序 + 存储
2. CPU的分类：功能，制造工艺，使用场合

### CPU性能论
1. 主频与性能的关系：性能与主频正相关，主频不是决定性能的唯一因素；且主频不能无限提升
2. 性能是在更短的时间内解决问题：SPEC CPU 性能评价标准

### 人人可学CPU
1. CPU发展的驱动力：
  + 应用需求
  + 生产工艺进步
  + 科学探索

### 计算机的语言：指令集
1. 指令集是CPU运行的软件的二进制编码格式，他是软件和硬件的接口
2. CPU的兼容性：能够识别相同指令的不同CPU
3. 指令集是软件生态的源头

### 精简指令集
1. CISC：复杂指令集
2. RISC：精简指令集
3. x86指令集在外部采用CISC，内部采用RISC；对CISC指令进行“预译码”，得到内部指令，也称为“微操作”，对内部指令的执行则采用RISC的设计思想
4. 指令越多，带来的问题：
  + CPU的制造更复杂
  + 指令之间的功能重复
  + 指令的长度不同，不利于实现流水线结构和编译优化

### 汇编语言
1. 汇编语言是CPU机器指令的助记符，通过汇编器将汇编语言翻译为对应的机器指令
2. 高级语言则通过编译器将高级语言编译为机器指令

### 做CPU就是做微结构
1. 微结构（微架构）是指一个实际CPU的电路设计
2. 指令集属于标准规范，微结构则是硬件方案；相同的指令集可以采用不同硬件设计方案
3. IP核：一个设计好的电路模块，可以在不同芯片中重复使用；软IP：电路的逻辑功能，硬IP：电路的晶体版图
4. SoC（片上系统）：在一个芯片中集成多个电路模块，组成形成具有接近于完整计算机功能的电路系统

### 解读功耗
1. 功耗：电子设备在单位时间内所消耗的电能，单位是瓦特（W）
2. 降低功耗的办法：
  + 先进的半导体生产工艺
  + 操作系统实现电源管理
  + 运行负载自动调整主频

### 摩尔定律传奇
1. 摩尔定律是人为定义
2. Tick-Tock模型：由 Intel提出，Tick 提升CPU的制造工艺，Tock带来更好的微结构设计；后更改为：制程-架构-优化 三阶段

### 通用还是专用
1. 操作系统是计算机的管理者
2. 异构计算：不同类型的计算单元合作完成计算任务，每个计算单元采用不同的架构，分别擅长处理某一类型的计算任务。主要基于两个思想
  + 专人做专事
  + 把软件的负担减轻，移交部分工作给硬件

3. 协处理器
4. Big-little架构：由ARM公司提出，Big核的性能高，功耗高，little核性能低，功耗低；Big核用于处理高性能任务，little核用于处理低功耗任务

### 后门和漏洞
1. 常见的后门：
  + CPU存在未公开的接口收集用户信息
  + CPU存在未公开的接口实现恶意控制

2. 常见的漏洞：
  + CPU结构复杂导致产生缺陷的机会增加
  + 无法证明产品没有漏洞


## CPU原理篇

### 理论基石

1. 重要的基础理论：
   + 布尔代数
   + 数字电路设计
   + 计算机系统结构
2. CPU设计分为“前端”和“后端”，前端部分描述的是电路的逻辑功能，后端部分描述的是晶体管在芯片中的实际位置，即版图

### 二进制

1. 晶体管是CPU的基础构成单位，在现代计算机中，物理器件的最小单元是CMOS（互补金属氧化物半导体）晶体管，组成材料：硅，二氧化硅，金属，多晶硅
2. 数字计算机不能精确表示小数

### CPU的天职：数值运算

1. 加法器是CPU最基础的运算单元，ALU（算术逻辑单元）是实现多种数值计算功能的部件
2. 寄存器是CPU中用于存储数据的单元，位于CPU内部，而存储器位于CPU外部

### 流水线的奥秘

1. 流水线：CPU将一条指令且分成不同的执行阶段，不同的阶段由独立的电路模块负责执行，宏观上实现多条指令同时执行
2. 流水线并不是越深越好，首先，会增加电路复杂程度，其次增加指令执行的额外时间

### 乱序执行并不是没有秩序

1. 动态流水线中指令的实际执行顺序和软件中出现的顺序不同
2. 指令之间的相关性：结构相关，数据相关，控制相关
3. 动态流水线是CPU使用电路硬件判断指令相关性，对没有相关性的指令进行重新排列的一种技术
4. 动态流水线经典算法：`Tomasulo`，寄存器重命名是该技术的精髓
5. 乱序执行：有序取指，重新排列执行顺序，有序结束
6. 乱序执行的三个重要概念：
   + 保留站
   + 重命名寄存器
   + ROB

### 多发射和转移猜测

1. 多发射：流水线的每一个阶段都能处理多于一条的指令，在一条流水线上增加了处理指令的宽度
2. 转移猜测：CPU流水线针对转移指令的优化机制

### 包纳天地的内存

1. 内存控制器是CPU和内存之间接口
2. 缓存：CPU和内存之间的一个数据存储区域，用来提高CPU访问内存的速度
3. 虚拟内存：操作系统管理内存的一种机制，使多个同时运行的应用程序能够共享内存
   + 虚拟内存的两种实现方式：分段和分页

### CPU的“外交”

1. CPU特权级：用于将软件指令设置成不同的权限
2. 中断源于CPU外围设备，例外源于CPU内部指令
3. I/O总线是连接CPU和外围设备的桥梁
4. DMA控制器使外设数据直接传递到内存中，不用占用CPU

# 个人总结

补充之前看过的书的笔记

这本书对新手确实很友好，基本上现代CPU的基本部件和使用的技术都有涉及，但是并没有深入地介绍，所以还需要其他书籍进行补充

